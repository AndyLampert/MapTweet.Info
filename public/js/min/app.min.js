"use strict";

var glutApp = angular.module("glutApp", [ "ngResource", "ngRoute", "glutSearchControllers", "glutResultsControllers", "glutLatLngServices", "glutTwitterSearchServices", "ui.bootstrap", "ui.map" ]);

glutApp.config([ "$routeProvider", function(a) {
    a.when("/", {
        templateUrl: "partials/main",
        controller: "searchCtrl"
    }).when("/search/:searchId", {
        templateUrl: "partials/searchResults",
        controller: "resultsCtrl"
    }).otherwise({
        redirectTo: "/"
    });
} ]), $(document).ready(function() {
    $(document).on("click", "[data-toggle=offcanvas]", function() {
        $(".row-offcanvas").toggleClass("active");
    });
});

var glutResultsControllers = angular.module("glutResultsControllers", []);

glutResultsControllers.controller("resultsCtrl", [ "$scope", "$routeParams", "factoryTwitterSearch", function(a, b, c) {
    console.log("loaded resultsCtrl"), a.searchId = b.searchId, a.results = {}, a.results.tweets = [], 
    a.results.geoTweets = [], a.results.returned = !1, c.getTweetsBySearchId(b.searchId).then(function(b) {
        console.log("found search and pulled data to the scope level-", b), a.results.tweets = b.statuses, 
        a.results.geoTweets = a.results.tweets.filter(function(a) {
            return null != a.geo;
        }), a.results.returned = !0;
    }), a.mapOptions = {
        center: new google.maps.LatLng(35.784, -78.67),
        zoom: 15,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
} ]);

var glutSearchControllers = angular.module("glutSearchControllers", []);

glutSearchControllers.controller("searchCtrl", [ "$scope", "factoryLatLng", "factoryTwitterSearch", function(a, b, c) {
    console.log("glutControllers and MainCtrl loaded"), a.search = {}, a.search.location = "", 
    a.search.radiusUnit = "Km", a.search.useCurrentLocation = "Use My Current Location", 
    a.search.usedCurrentLocation = !1, a.changeRadiusUnit = function(b) {
        a.search.radiusUnit = b;
    }, a.getGeo = function(c) {
        b.getLatLng(c).then(function(b) {
            a.search.latitude = b.latitude, a.search.longitude = b.longitude;
        });
    }, a.queryLocations = function(a) {
        return b.queryLocations(a);
    }, a.getCurrentLocation = function() {
        b.getCurrentLocation(function(b) {
            b.notSupported ? a.search.useCurrentLocation = "Unable to use My Location" : (a.search.latitude = b.latitude, 
            a.search.longitude = b.longitude, a.search.usedCurrentLocation = !0, a.$apply());
        });
    }, a.submitSearch = function() {
        c.postTwitterSearch(a.search);
    };
} ]);

var glutLatLngServices = angular.module("glutLatLngServices", []);

glutLatLngServices.factory("factoryLatLng", [ "$http", function(a) {
    return {
        getLatLng: function(b) {
            return a.get("/api/getLatLng", {
                params: {
                    location: b
                }
            }).then(function(a) {
                return a.data;
            });
        },
        queryLocations: function(b) {
            return a.get("http://maps.googleapis.com/maps/api/geocode/json", {
                params: {
                    address: b,
                    sensor: !1
                }
            }).then(function(a) {
                var b = [];
                return angular.forEach(a.data.results, function(a) {
                    b.push(a.formatted_address);
                }), b;
            });
        },
        getCurrentLocation: function(a) {
            navigator.geolocation ? navigator.geolocation.getCurrentPosition(function(b) {
                a(b.coords);
            }) : a({
                notSupported: !0
            });
        }
    };
} ]);

var glutTwitterSearchServices = angular.module("glutTwitterSearchServices", []);

glutTwitterSearchServices.factory("factoryTwitterSearch", [ "$http", "$location", function(a, b) {
    return {
        postTwitterSearch: function(c) {
            console.log("saving this search-", c), a.post("/api/search", c).success(function(a) {
                console.log("savedSearch-", a);
                var c = a._id;
                b.path("/search/" + c);
            });
        },
        getTweetsBySearchId: function(b) {
            return console.log("finding this search and getting tweets-", b), a.get("/api/search?searchId=" + b).then(function(a) {
                return console.log("found-", a), a.data;
            });
        }
    };
} ]);
//# sourceMappingURL=app.min.map